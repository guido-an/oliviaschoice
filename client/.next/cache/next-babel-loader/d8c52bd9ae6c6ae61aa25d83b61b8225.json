{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nimport ImageUploading from \"react-images-uploading\";\nimport storage from \"../../firebase/index\";\nimport axios from 'axios';\nconst service = axios.create({\n  baseURL: process.env.APP_API,\n  withCredentials: true\n});\n\nconst imageUpload = () => {\n  const [images, setImages] = React.useState([]);\n  const maxNumber = 69;\n\n  const onChange = imageList => {\n    setImages(imageList);\n  };\n\n  const onImageSave = e => {\n    // data for submit\n    const saveImages = images;\n    saveImages.forEach(image => {\n      handleUpload(image);\n    });\n  };\n\n  const putImageOnProduct = async (url, name) => {\n    const response = await service.post('/api/product/update', {\n      url: url,\n      name: name\n    });\n  };\n\n  const handleUpload = imageToUpload => {\n    if (imageToUpload) {\n      const image = imageToUpload.file;\n      const uploadTask = storage.ref(`images/${image.name}`).put(image);\n      uploadTask.on(\"state_changed\",\n      /*  snapshot => {\n         // progress function ...\n         const progress = Math.round(\n           (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n         );\n         //this.setState({ progress });\n       },\n       error => {\n         // Error function ...\n         console.log(error);\n       }, */\n      () => {\n        // complete function ...\n        storage.ref(\"images\").child(image.name).getDownloadURL().then(url => {\n          putImageOnProduct(url, image.name);\n        });\n      });\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: \"App\"\n  }, __jsx(ImageUploading, {\n    multiple: true,\n    value: images,\n    onChange: onChange,\n    maxNumber: maxNumber,\n    dataURLKey: \"data_url\"\n  }, ({\n    imageList,\n    onImageUpload,\n    onImageRemoveAll,\n    onImageRemove,\n    isDragging,\n    dragProps\n  }) => // write your building UI\n  __jsx(\"div\", {\n    className: \"upload__image-wrapper\"\n  }, __jsx(\"button\", _extends({\n    style: isDragging ? {\n      color: \"red\"\n    } : undefined,\n    onClick: onImageUpload\n  }, dragProps), \"Click or Drop here\"), \"\\xA0\", __jsx(\"button\", {\n    onClick: onImageRemoveAll\n  }, \"Remove all images\"), imageList.map((image, index) => __jsx(\"div\", {\n    key: index,\n    className: \"image-item\"\n  }, __jsx(\"img\", {\n    src: image[\"data_url\"],\n    alt: \"\",\n    width: \"100\"\n  }), __jsx(\"div\", {\n    className: \"image-item__btn-wrapper\"\n  }, __jsx(\"button\", {\n    onClick: () => onImageRemove(index)\n  }, \"Remove\")))))), __jsx(\"button\", {\n    onClick: () => onImageSave()\n  }, \"Save\"));\n};\n\nexport default imageUpload;","map":null,"metadata":{},"sourceType":"module"}