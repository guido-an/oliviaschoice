{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[13],{\"1oKm\":function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/carrello\",function(){return n(\"IHXq\")}])},BsWD:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return o}));var r=n(\"a3WO\");function o(t,e){if(t){if(\"string\"===typeof t)return Object(r.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return\"Object\"===n&&t.constructor&&(n=t.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(t):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(t,e):void 0}}},IHXq:function(t,e,n){\"use strict\";n.r(e);var r=n(\"q1tI\"),o=n.n(r),a=n(\"TJRf\"),c=n(\"YFqc\"),u=n.n(c),i=o.a.createElement;e.default=function(){var t=Object(r.useContext)(a.a),e=t.updateCart,n=t.totalPrice,o=t.productsInCart,c=t.setProductsInCart,f=t.calculateTotalPrice;Object(r.useEffect)((function(){o||c(o=[]),o.forEach((function(t){document.getElementById(t._id).value=t.boughtQuantity})),f()}),[o,n]);var l=function(t){var n;e(t,document.getElementById(t._id).value),n=t,document.getElementById(n._id).value>n.effectiveStock?(document.getElementById(\"checkout-btn\").disabled=!0,document.getElementById(\"\".concat(n._id,\"-msg\")).innerHTML=\"Sono rimaste \".concat(n.effectiveStock,\" unit\\xe0 di questo prodotto\")):(document.getElementById(\"checkout-btn\").disabled=!1,document.getElementById(\"\".concat(n._id,\"-msg\")).innerHTML=\"\")};return i(\"div\",null,i(\"h1\",null,\"Carrello\"),o&&o.map((function(t){return i(\"div\",{key:t._id},i(u.a,{href:\"/prodotto/[id]\",as:\"/prodotto/\".concat(encodeURIComponent(t._id))},i(\"p\",null,t.name)),i(\"p\",null,i(\"strong\",null,\"Prezzo: \"),\"\\u20ac \",t.price),i(\"p\",null,i(\"strong\",null,\"Subtotale: \"),\"\\u20ac \",t.price*t.boughtQuantity),i(\"input\",{onChange:function(){return l(t)},type:\"number\",id:t._id,min:\"1\"}),i(\"button\",{onClick:function(){return function(t){var e=o.filter((function(e){return e._id!==t._id}));c(e)}(t)}},\"x\"),i(\"p\",{id:\"\".concat(t._id,\"-msg\")}))})),i(\"h2\",null,\"Total price: \",n),i(u.a,{href:\"/checkout\"},i(\"button\",{id:\"checkout-btn\"},\"Concludi ordine\")))}},TJRf:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return h}));var r=n(\"o0o1\"),o=n.n(r),a=n(\"a3WO\");var c=n(\"BsWD\");function u(t){return function(t){if(Array.isArray(t))return Object(a.a)(t)}(t)||function(t){if(\"undefined\"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(c.a)(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}var i=n(\"HaE+\"),f=n(\"q1tI\"),l=n.n(f),s=n(\"vDqi\"),d=n.n(s),p=l.a.createElement,h=Object(f.createContext)();d.a.create({baseURL:\"http://localhost:5000\",withCredentials:!0}),e.b=function(t){var e=Object(f.useState)([]),n=e[0],r=e[1],a=Object(f.useState)(0),c=a[0],l=a[1],s=Object(f.useState)(!1),d=s[0],v=s[1],b=Object(f.useState)(null),m=b[0],y=b[1];Object(f.useEffect)((function(){var t=JSON.parse(localStorage.getItem(\"productsInCart\"));r(t),v(!0)}),[]);var g=function(){var t=Object(i.a)(o.a.mark((function t(e,a){var c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=!1,n&&n.forEach((function(t){t._id===e._id&&(c=!0,e.boughtQuantity=Number(t.boughtQuantity)+Number(a),e.boughtQuantity>e.effectiveStock&&(e.boughtQuantity=e.effectiveStock))})),n?c?r(u(n)):(e.boughtQuantity=Number(a),r([].concat(u(n),[e]))):(e.boughtQuantity=Number(a),r([e]));case 3:case\"end\":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();d&&localStorage.setItem(\"productsInCart\",JSON.stringify(n));return p(h.Provider,{value:{productsInCart:n,totalPrice:c,shippingInfo:m,setProductsInCart:r,addToCart:g,updateCart:function(t,e){var o=n.map((function(n){return n._id===t._id&&(n.boughtQuantity=Number(e)),n}));r(o)},setTotalPrice:l,setShippingInfo:y,calculateTotalPrice:function(){if(console.log(n,\"productsIn cart cart context\"),n){var t=0;n.forEach((function(e){t+=e.boughtQuantity*e.price})),l(t)}}}},t.children)}},YFqc:function(t,e,n){t.exports=n(\"cTJO\")},a3WO:function(t,e,n){\"use strict\";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,\"a\",(function(){return r}))},cTJO:function(t,e,n){\"use strict\";var r=n(\"J4zp\"),o=n(\"284h\");e.__esModule=!0,e.default=void 0;var a,c=o(n(\"q1tI\")),u=n(\"elyg\"),i=n(\"nOHt\"),f=new Map,l=window.IntersectionObserver,s={};var d=function(t,e){var n=a||(l?a=new l((function(t){t.forEach((function(t){if(f.has(t.target)){var e=f.get(t.target);(t.isIntersecting||t.intersectionRatio>0)&&(a.unobserve(t.target),f.delete(t.target),e())}}))}),{rootMargin:\"200px\"}):void 0);return n?(n.observe(t),f.set(t,e),function(){try{n.unobserve(t)}catch(e){console.error(e)}f.delete(t)}):function(){}};function p(t,e,n,r){(0,u.isLocalURL)(e)&&(t.prefetch(e,n,r).catch((function(t){0})),s[e+\"%\"+n]=!0)}var h=function(t){var e=!1!==t.prefetch,n=c.default.useState(),o=r(n,2),a=o[0],f=o[1],h=(0,i.useRouter)(),v=h&&h.pathname||\"/\",b=c.default.useMemo((function(){var e=(0,u.resolveHref)(v,t.href);return{href:e,as:t.as?(0,u.resolveHref)(v,t.as):e}}),[v,t.href,t.as]),m=b.href,y=b.as;c.default.useEffect((function(){if(e&&l&&a&&a.tagName&&(0,u.isLocalURL)(m)&&!s[m+\"%\"+y])return d(a,(function(){p(h,m,y)}))}),[e,a,m,y,h]);var g=t.children,E=t.replace,_=t.shallow,I=t.scroll;\"string\"===typeof g&&(g=c.default.createElement(\"a\",null,g));var O=c.Children.only(g),w={ref:function(t){t&&f(t),O&&\"object\"===typeof O&&O.ref&&(\"function\"===typeof O.ref?O.ref(t):\"object\"===typeof O.ref&&(O.ref.current=t))},onClick:function(t){O.props&&\"function\"===typeof O.props.onClick&&O.props.onClick(t),t.defaultPrevented||function(t,e,n,r,o,a,c){(\"A\"!==t.currentTarget.nodeName||!function(t){var e=t.currentTarget.target;return e&&\"_self\"!==e||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which}(t)&&(0,u.isLocalURL)(n))&&(t.preventDefault(),null==c&&(c=r.indexOf(\"#\")<0),e[o?\"replace\":\"push\"](n,r,{shallow:a}).then((function(t){t&&c&&(window.scrollTo(0,0),document.body.focus())})))}(t,h,m,y,E,_,I)}};return e&&(w.onMouseEnter=function(t){(0,u.isLocalURL)(m)&&(O.props&&\"function\"===typeof O.props.onMouseEnter&&O.props.onMouseEnter(t),p(h,m,y,{priority:!0}))}),(t.passHref||\"a\"===O.type&&!(\"href\"in O.props))&&(w.href=(0,u.addBasePath)(y)),c.default.cloneElement(O,w)};e.default=h}},[[\"1oKm\",0,1,2,3,4]]]);","extractedComments":[]}